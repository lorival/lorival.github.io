<body class="body-blog-post">
    <!doctype html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
<meta name="viewport"
        content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Lorival Smolski Chapuis</title>
        <script data-ad-client="ca-pub-5019351576394165" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-60447750-1"></script>
        <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-60447750-1');
        </script>

        
        <script>
                (function(h,o,t,j,a,r){
                h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
                h._hjSettings={hjid:1770825,hjsv:6};
                a=o.getElementsByTagName('head')[0];
                r=o.createElement('script');r.async=1;
                r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
                a.appendChild(r);
                })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
        </script>

        <script type='text/javascript' src='https://platform-api.sharethis.com/js/sharethis.js#property=5e981c7368865d0012fff460&product=inline-share-buttons' async='async'></script>
        <script type='text/javascript' src='https://platform-api.sharethis.com/js/sharethis.js#property=5e981c7368865d0012fff460&product=sticky-share-buttons&cms=sop' async='async'></script>
        <script type='text/javascript' src='https://platform-api.sharethis.com/js/sharethis.js#property=5e981c7368865d0012fff460&product=inline-reaction-buttons&cms=sop' async='async'></script>
    <link rel="stylesheet" href="/css/bootstrap.css">
<link rel="stylesheet" href="/css/Pe-icon-7-stroke.css">
<link rel="stylesheet" href="/css/font-awesome.min.css">
<link rel="stylesheet" href="/css/social-icons.css">
<link rel="stylesheet" href="/css/owl.carousel.css">
<link rel="stylesheet" href="/css/owl.theme.css">

<link rel="stylesheet" href="/css/main.css">
    <link rel="apple-touch-icon" sizes="76x76" href="/images/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="152x152" href="/images/apple-touch-icon-152x152.png">
<link rel="icon" type="image/png" href="/images/favicon-196x196.png" sizes="196x196">
<link rel="icon" type="image/png" href="/images/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/images/favicon-32x32.png" sizes="32x32">

</head>
<body>

<header class="navbar-fixed-top">
    <div class="container">
        <div class="row">

            <div class="col-lg-12">
                <div class="header-top">
                    <div class="header-top-logo">
                        <a href="/" title="Full Stack Hacker"><img src="/images/home/logo.png" alt="Full Stack Hacker"></a>
                    </div>
                    <div class="header-top-text">
                        <p><span class="font-italic">“If knowledge can create problems, it is not through ignorance that we can solve them.”</span> Isaac Asimov</p>
                    </div>
                    <nav class="header-top-nav">
                        <ul>
                            
                            <li><a href="#" class="light-link" title="Menu">
                                <div id="menu-animate-icon" class="header-top-nav-menu-icon">
                                    <span></span>
                                    <span></span>
                                    <span></span>
                                </div>
                            </a></li>
                        </ul>
                    </nav>
                </div>
            </div>

            <div class="col-lg-12">
                <nav class="header-nav">
                    <ul>
                         
 
    
        <li>
            <a href="/pt/" title="Início">
                <span>Início</span>
            </a>
        </li>
     
 
    
        <li class="dropdown">
            <a href="#" class="dropdown-toggle" title="Artigos">Artigos</a>
            <ul class="dropdown-menu">
                
    
         
    
         
    
         
    
        
            <li class="nav-elipse-green">
                <a href="/categories/security" title="Security">Security</a>
            </li>
         
    
         
    



            </ul>
        </li>
     
 
    
        <li>
            <a href="/inspirations/" title="Inspirações">
                <span>Inspirações</span>
            </a>
        </li>
     
 
    
        <li>
            <a href="/summary/" title="Sumário">
                <span>Sumário</span>
            </a>
        </li>
     
 
    
        <li>
            <a href="/about/" title="Sobre mim">
                <span>Sobre mim</span>
            </a>
        </li>
     


<li style="float: right">
    
</li>
                    </ul>
                </nav>
            </div>
        </div>
  
    </div>
</header>

<nav class="mobile-nav header-nav">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                
            </div>
        </div>
    </div>
</nav>


    <div class="article-nav">
        <ul>
            <li>
                
            </li>
            <li>
                
                <a href="/posts/cifras-de-fluxo-e-como-quebrar-a-camada-de-seguran%C3%A7a-wep/" title="Anterior" style="background-color: rgba(243, 243, 243, 0.95);">
                    <i class="pe-7s-angle-left"></i>
                    <div>
                        <p>Anterior</p>
                        <h3>Cifras de fluxo e como quebrar a camada de segurança WEP</h3>
                    </div>
                </a>
                
            </li>
        </ul>
    </div>

    <main>
        <div class="container">
            <section class="articles articles-blog-post">
                <article class="articles-blog-post">
                    <div class="">
                        <div class="row">
                            <div class="col-lg-12 col-xs-12">
                                
     

     

     

    
        <div style="height: 10px;" class="bkg-green"></div>
     

     

                                <div class="articles-header">
                                    <span><i class="pe-7s-clock" style="font-weight: bold"></i> Leia em 4 min &nbsp;</span>
                                    <span><i class="pe-7s-date" style="font-weight: bold"></i> 
    dez de 2018
</span>
                                    
                                    
     

     

     

        
        <span class="articles-header-category">
            <a href="/categories/security" class="green" title="Security">Security</a>
        </span>
     

     


                                </div>
                                <div class="articles-content" style="text-align: justify;">
                                    <img src="/posts/2018/12-block-ciphers.jpg" style="width: 100%;height: auto;">
                                    <div class="articles-header" style="margin: 0px;">
                                        
    <span class="articles-header-tag">
        <a href="/tags/algorithm">algorithm</a>
    </span>

    <span class="articles-header-tag">
        <a href="/tags/cipher">cipher</a>
    </span>

    <span class="articles-header-tag">
        <a href="/tags/symetric">symetric</a>
    </span>


                                    </div>
                                    <h1 class="articles-content-blog-post-title"><a href="/personas/" class="light-link">
    <img src="/images/persona/junior.png" title="junior" style="width: 50px; height:auto;">
</a>
 Cifra de bloco e permutações pseudo-aleatórias</h1>
                                    <p><p>Depois de entender como funcionam as <strong>stream ciphers</strong> ou <strong>cifras de fluxo</strong> no post <a href="/posts/cifras-de-fluxo-e-como-quebrar-a-camada-de-seguran%C3%A7a-wep/">Cifras de fluxo e como quebrar a camada de segurança WEP</a>), eu gostaria de descrever uma outra primitiva mas poderosa cifra, chamada de <strong>cifra de bloco</strong> ou no original <strong>block cipher</strong>. Este post servirá como base para futuros posts sobre <strong>DES</strong> e <strong>AES</strong>, por exemplo.</p>

<p>Como vimos no post <a href="/posts/o-que-%C3%A9-uma-cifra-de-chave-sim%C3%A9trica/">O que é uma cifra de chave simétrica?</a>, uma cifra é formada por um algoritmo <strong>E</strong> (encriptação) e um algoritmo <strong>D</strong> (decriptação), uma cifra de bloco possui algumas características sobre estes 2 algoritmos:</p>

<ul>
<li>A chave é simétrica e possui um número de bits (quanto maior a chave mais segura e mais lento será o processamento)</li>
<li>O conteúdo a ser cifrado é um bloco de tamanho fixo com uma quantidade de bits e o conteúdo cifrado tem sempre o mesmo tamanho do bloco do texto não cifrado</li>
</ul>

<p>As cifras de blocos funcionam por iteração, basicamente a chave é dividida em diversas outras chaves menores em forma circular e a forma de encriptar é chamar a função que encripta (chamada de <em>round function</em>) diversas vezes usando uma chave diferente. O texto encriptado se torna a entrada da função novamente. Vamos ver um exemplo simples:</p>

<ul>
<li>Vamos dizer que o bloco de mensagem (<strong>m20</strong>) tem tamanho 20 bits, apenas para ilustrar.</li>
<li>Vamos dizer que nossa chave tem 10 bits: a1a2a3a4a5a6a7a8a9a0</li>
<li>Vamos dizer também que a quantidade de iterações são 3 e que cada chave circular terá 8 bits (k1 = a1a2a3a4a5a6a7a8, k2=a9a0a1a2a3a4a5a6a, k3=7a8a9a0a1a2a3a4a5)</li>
<li>Na primeira iteração chamaremos a função de encriptação (<em>round function</em>, <strong>R</strong>), enviando a chave da primeira interação e a mensagem a ser cifrada assim: <strong>R(k1, m20) = m20A</strong></li>
<li>Na segunda iteração chamaremos a função novamente, mas agora usando a segunda chave e o resultado da iteração anterior como mensagem assim: <strong>R(k2, m20A) = m20B</strong></li>
<li>A última você já entendeu: <strong>R(k3, m20B) = m20C</strong></li>
</ul>

<p>O tamanho final não mudou, continua sendo uma mensagem de 20 bits, porém agora encriptada.
Diferentes cifras de blocos possuem parâmetros diferentes para cada um destes citados, veja os 2 exemplos mais comuns:</p>

<p><a href="https://pt.wikipedia.org/wiki/3DES">Triple DES</a> (3DES):</p>

<ul>
<li>possui blocos de 64 bits</li>
<li>uma chave de 168 bits (3 chaves de 56 bitscal)</li>
<li>48 iterações de encriptação, ou seja, a chave será quebrada em 48 outras chaves</li>
</ul>

<p><a href="https://pt.wikipedia.org/wiki/Advanced_Encryption_Standard">Advanced Encryption Standard</a> (AES):</p>

<ul>
<li>possui blocos de 128 bits</li>
<li>chaves de 128, 192 e 256 bits</li>
<li>para chave de 128 bits são utilizadas 10 iterações de encriptação, ou seja, a chave será dividida em 10 outras chaves</li>
</ul>

<p>Para entendermos melhor estes valores, vamos ver as funções e permutações pseudo-aleatórias.</p>

<h3 id="funções-e-permutações-pseudo-aleatórias">Funções e permutações pseudo-aleatórias</h3>

<p>Como vimos no post sobre generating-random-numbers, os geradores de números pseudo-aleatórios (pseudorandom generators - PRG) são usados para criar sequências de números, de maneira eficiente, que sejam imprevisíveis e sigam uma distribuição estatística. Estes geradores são a base para criar funções e permutações pseudo-aleatórias (pseudorandom functions, <strong>PRF</strong>, and permutations, <strong>PRP</strong>) usadas na criptografia, mais precisamente para cifras de blocos.</p>

<p>Funções pseudo-aleatórias (<strong>PRF</strong>) são funções determinísticas cujo retorno é uma saída que não pode ser distinguível de uma sequência aleatória. A diferença dela para uma <strong>PRG</strong> é que ela aceita qualquer dado como entrada, não somente números.</p>

<blockquote class="secondary-quote">
Uma PRF é definida sobre um conjunto de chaves (K), um conjunto de entradas (X) e um conjunto de saída (Y): F: K x X -> Y 
</blockquote>

<p>Como requisito temos que ter:</p>

<ul>
<li>Um algoritmo eficiente de validar dado uma chave e uma entrada: F(k,x)</li>
</ul>

<p>Permutações pseudo-aleatórias (<strong>PRP</strong>) são semelhantes as <strong>PRFs</strong>, porém cada valor do conjunto de entrada tem um mapeamento um-para-um para o conjunto de saída, tendo assim o mesmo tamanho e podendo fazer uma inversão, ou seja, cada valor do conjunto de saída tem um mapeamento um-para-um para o conjunto de entrada.</p>

<blockquote class="secondary-quote">
Uma PRP é definida sobre um conjunto de chaves (K), um conjunto (X): E: K x X -> X 
</blockquote>

<p>Como requisitos temos que ter:</p>

<ul>
<li>Um algoritmo determinístico eficiente para validar dado uma chave e uma entrada: E(k,x)</li>
<li>A função E(k, .) é mapeada um-para-um, ou seja, para toda entrada em um conjunto X terá um mapeamento único para outro conjunto X</li>
<li>Devido ao item anterior, deve ser possível ter um algoritmo de inversão, visto que existe um mapeamento um-para-um entre os 2 conjuntos: D(k,y)</li>
</ul>

<p>Agora vamos aplicar PRP aos 2 exemplos de cifras de blocos:</p>

<ul>
<li>3DES = K x X -&gt; X, K={0,1}¹⁶⁸, X={0,1}⁶⁴ ==&gt; por isto que os blocos possuem 64 bits, é o tamanho do conjunto X e como vemos a chavem tem 168 bits</li>
<li>AES = K x X -&gt; X, K=X={0,1}¹²⁸ ==&gt; neste caso a chave possuí 128 bits e o bloco de entrada e por consequência a saída também</li>
</ul>

<p>Em resumo, todo PRP é também um PRF, porém onde o X=Y (conjunto de entrada e saída são iguais) e também seja eficientemente invertido.</p>

<p>Agora que entendemos o que é e como se caracteriam uma cifra de bloco, irei tratar de algumas famosas cifras com estas características em posts futuros.</p>

<p>Grande abraço e até já :)</p></p>
                                    <div>
                                        <hr>
                                        <span><i class="pe-7s-date" style="font-weight: bold"></i> Atualizado em 
    dez de 2018
</span>
                                    </div>
                                </div>
                                
                                <div class="sharethis-inline-reaction-buttons"></div>
                            </div>
                        </div>
                    </div>
                </article>
            </section>
        </div>

        <div class="articles-info">
            <section class="articles-info-section">
                <div class="container">
                    <div class="row">
                        <div class="col-lg-12 col-xs-12">
                            <div class="articles-author">
    <img src="/images/about/avatar.png" class="rounded-circle" alt="Lorival S. Chapuis" data-rjs="2">
    <div class="articles-author-right" style="margin: 0px 0 0 100px;">
        Escrito por:
        <h4>Lorival S. Chapuis</h4>
        
        <p>Engenheiro de software focado em escalabilidade, gamer nas horas de folga, entusiasta em inteligência computacional e apaixonado pela minha família e por desenvolvimento de software.</p>
    </div>
</div>
                        </div>
                    </div>
                </div>
            </section>
        </div>
        
        <div class="container">
            <div class="row" style="margin-top: 20px;">
                <div class="col-lg-12 col-xs-12">
                    <div id="disqus_thread"></div>
                </div>
            </div>
        </div>
    </main>
</body>

<footer>
    <div class="container">
        <div class="row">
            <div class="col-xs-12">
                <div class="copyright" style="text-align: center;">
                    <p class="font-primary" style="float: none;">
                        Made and hosted with <i class="fa fa-heart" style="color: #e25555;;"></i> using
                        <a href="https://gohugo.io/" target="_BLANK" class="black">Hugo</a> and <a href="https://pages.github.com/" target="_BLANK" class="black">Github Pages</a>. &copy; 2017-2020</p>
                </div>
            </div>
        </div>
    </div>
</footer>


<script type="text/javascript" src="/js/jquery-1.12.0.min.js"></script>
<script type="text/javascript" src="/js/tether.min.js"></script>
<script type="text/javascript" src="/js/bootstrap.min.js"></script>
<script type="text/javascript" src="/js/retina.min.js"></script>
<script type="text/javascript" src="/js/owl.carousel.min.js"></script>
<script type="text/javascript" src="/js/webfont.js"></script>


<script type="text/javascript" src="/js/scripts.js"></script>





<script>
    if (window.location.host.indexOf('loriv.al') > -1 && window.location.protocol != "https:"){
        window.location.protocol = "https";
    }
</script>

</body>

</html>