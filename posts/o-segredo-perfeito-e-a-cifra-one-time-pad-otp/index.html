<body class="body-blog-post">
    <!doctype html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
<meta name="viewport"
        content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Lorival Smolski Chapuis</title>
        <script data-ad-client="ca-pub-5019351576394165" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-60447750-1"></script>
        <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-60447750-1');
        </script>

        
        <script>
                (function(h,o,t,j,a,r){
                h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
                h._hjSettings={hjid:1770825,hjsv:6};
                a=o.getElementsByTagName('head')[0];
                r=o.createElement('script');r.async=1;
                r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
                a.appendChild(r);
                })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
        </script>

        <script type='text/javascript' src='https://platform-api.sharethis.com/js/sharethis.js#property=5e981c7368865d0012fff460&product=inline-share-buttons' async='async'></script>
        <script type='text/javascript' src='https://platform-api.sharethis.com/js/sharethis.js#property=5e981c7368865d0012fff460&product=sticky-share-buttons&cms=sop' async='async'></script>
        <script type='text/javascript' src='https://platform-api.sharethis.com/js/sharethis.js#property=5e981c7368865d0012fff460&product=inline-reaction-buttons&cms=sop' async='async'></script>
    <link rel="stylesheet" href="/css/bootstrap.css">
<link rel="stylesheet" href="/css/Pe-icon-7-stroke.css">
<link rel="stylesheet" href="/css/font-awesome.min.css">
<link rel="stylesheet" href="/css/social-icons.css">
<link rel="stylesheet" href="/css/owl.carousel.css">
<link rel="stylesheet" href="/css/owl.theme.css">

<link rel="stylesheet" href="/css/main.css">
    <link rel="apple-touch-icon" sizes="76x76" href="/images/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="152x152" href="/images/apple-touch-icon-152x152.png">
<link rel="icon" type="image/png" href="/images/favicon-196x196.png" sizes="196x196">
<link rel="icon" type="image/png" href="/images/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/images/favicon-32x32.png" sizes="32x32">

</head>
<body>

<header class="navbar-fixed-top">
    <div class="container">
        <div class="row">

            <div class="col-lg-12">
                <div class="header-top">
                    <div class="header-top-logo">
                        <a href="/" title="Full Stack Hacker"><img src="/images/home/logo.png" alt="Full Stack Hacker"></a>
                    </div>
                    <div class="header-top-text">
                        <p><span class="font-italic">“If knowledge can create problems, it is not through ignorance that we can solve them.”</span> Isaac Asimov</p>
                    </div>
                    <nav class="header-top-nav">
                        <ul>
                            
                            <li><a href="#" class="light-link" title="Menu">
                                <div id="menu-animate-icon" class="header-top-nav-menu-icon">
                                    <span></span>
                                    <span></span>
                                    <span></span>
                                </div>
                            </a></li>
                        </ul>
                    </nav>
                </div>
            </div>

            <div class="col-lg-12">
                <nav class="header-nav">
                    <ul>
                         
 
    
        <li>
            <a href="/pt/" title="Início">
                <span>Início</span>
            </a>
        </li>
     
 
    
        <li class="dropdown">
            <a href="#" class="dropdown-toggle" title="Artigos">Artigos</a>
            <ul class="dropdown-menu">
                
    
         
    
         
    
         
    
        
            <li class="nav-elipse-green">
                <a href="/categories/security" title="Security">Security</a>
            </li>
         
    
         
    



            </ul>
        </li>
     
 
    
        <li>
            <a href="/inspirations/" title="Inspirações">
                <span>Inspirações</span>
            </a>
        </li>
     
 
    
        <li>
            <a href="/summary/" title="Sumário">
                <span>Sumário</span>
            </a>
        </li>
     
 
    
        <li>
            <a href="/about/" title="Sobre mim">
                <span>Sobre mim</span>
            </a>
        </li>
     


<li style="float: right">
    
</li>
                    </ul>
                </nav>
            </div>
        </div>
  
    </div>
</header>

<nav class="mobile-nav header-nav">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                
            </div>
        </div>
    </div>
</nav>


    <div class="article-nav">
        <ul>
            <li>
                
                <a href="/posts/cifras-de-fluxo-e-como-quebrar-a-camada-de-seguran%C3%A7a-wep/" title="Próximo" style="background-color: rgba(243, 243, 243, 0.95);">
                    <i class="pe-7s-angle-right"></i>
                    <div>
                        <p>Próximo</p>
                        <h3>Cifras de fluxo e como quebrar a camada de segurança WEP</h3>
                    </div>
                </a>
                
            </li>
            <li>
                
                <a href="/posts/o-que-%C3%A9-uma-cifra-de-chave-sim%C3%A9trica/" title="Anterior" style="background-color: rgba(243, 243, 243, 0.95);">
                    <i class="pe-7s-angle-left"></i>
                    <div>
                        <p>Anterior</p>
                        <h3>O que é uma cifra de chave simétrica?</h3>
                    </div>
                </a>
                
            </li>
        </ul>
    </div>

    <main>
        <div class="container">
            <section class="articles articles-blog-post">
                <article class="articles-blog-post">
                    <div class="">
                        <div class="row">
                            <div class="col-lg-12 col-xs-12">
                                
     

     

     

    
        <div style="height: 10px;" class="bkg-green"></div>
     

     

                                <div class="articles-header">
                                    <span><i class="pe-7s-clock" style="font-weight: bold"></i> Leia em 7 min &nbsp;</span>
                                    <span><i class="pe-7s-date" style="font-weight: bold"></i> 
    jul de 2018
</span>
                                    
                                    
     

     

     

        
        <span class="articles-header-category">
            <a href="/categories/security" class="green" title="Security">Security</a>
        </span>
     

     


                                </div>
                                <div class="articles-content" style="text-align: justify;">
                                    <img src="/posts/2018/07-one-time-pad.jpg" style="width: 100%;height: auto;">
                                    <div class="articles-header" style="margin: 0px;">
                                        
    <span class="articles-header-tag">
        <a href="/tags/otp">OTP</a>
    </span>

    <span class="articles-header-tag">
        <a href="/tags/algorithm">algorithm</a>
    </span>

    <span class="articles-header-tag">
        <a href="/tags/cipher">cipher</a>
    </span>

    <span class="articles-header-tag">
        <a href="/tags/cryptography">cryptography</a>
    </span>

    <span class="articles-header-tag">
        <a href="/tags/symetric">symetric</a>
    </span>


                                    </div>
                                    <h1 class="articles-content-blog-post-title"><a href="/personas/" class="light-link">
    <img src="/images/persona/junior.png" title="junior" style="width: 50px; height:auto;">
</a>
 O segredo perfeito e a cifra One Time Pad (OTP)</h1>
                                    <p><p>Hoje gostaria de trazer o primeiro exemplo de criptografia &ldquo;segura&rdquo; que coloquei no blog até o momento, explicar o porque ela é segura e também, como todo herói tem sua criptonita, apresentar suas falhas.</p>

<p>A cifra que estou a me referir é a <strong>cifra de uso único</strong> ou <strong>One Time Pad</strong> (OTP, mas não confundir com <a href="https://pt.wikipedia.org/wiki/Senha_descart%C3%A1vel">One Time Password</a>), desenvolvida por Vernam em 1917, ela tem uma história curiosa, é simples de entender e até segura se usada da maneira correta.</p>

<p>Esta cifra tem duas características importantes:</p>

<ul>
<li>A chave deve ser tão grande quanto a mensagem e deve ser números verdadeiramente aleatórios, não usar vale pseudo-aleatórios :) (se quiser saber mais veja meu post <a href="/posts/n%C3%BAmeros-aleat%C3%B3rios-gerados-por-computador-s%C3%A3o-mesmo-aleat%C3%B3rios/">Números aleatórios gerados por computador são mesmo aleatórios?</a>)</li>
<li>Basicamente o modo de encriptar e decriptar é fazer um <strong>XOR</strong> da mensagem com a chave, simples assim.</li>
</ul>

<p>Esta cifra é muito eficiente do ponto de vista computacional, ou seja, encripta e decripta muito rápido, mas é muito difícil de usar no mundo real. Eu nem estou me referindo a geração da chave, que já é um problema em si, eu me refiro em como enviar uma chave de forma segura que tenha o mesmo tamanho da mensagem? Vamos dizer que exista uma forma, bom, se você consegue enviar uma chave de forma segura do mesmo tamanho da mensagem, então não precisa da chave nem da criptografia, bastaria usar este mesmo mecanismo para enviar a mensagem e pronto! fim do post, até a próxima :)</p>

<p>Embora seja difícil de usar esta cifra na prática, o conceito por trás desta cifra vale muito a pena sua exploração.</p>

<h3 id="porque-esta-cifra-é-segura">Porque esta cifra é segura?</h3>

<hr />

<p>Bom, o que torna uma cifra segura? <a href="https://pt.wikipedia.org/wiki/Claude_Shannon">Claude Shannon</a>, conhecido como &ldquo;o pai da teoria da informação&rdquo;, nos trouxe sua definição de segurança que diz:</p>

<blockquote class="secondary-quote">
Se tudo que você vê é um texto encriptado/cifrado, então você não pode descobrir nenhuma informação sobre o texto original/puro.
</blockquote>

<p>Isto parece um conceito óbvio, mas gerar um texto crifrado que seja impossível de ter qualquer informação do texto original não é tão simples assim.</p>

<p>Shannon nos apresenta o conceito de <strong>segredo perfeito</strong>, ele nos diz que se você tiver duas mensagens diferentes, vamos dizer <strong>M1</strong> e <strong>M2</strong>, que tenham exatamente o mesmo tamanho, vamos dizer 100 bytes, então a probabilidade de encriptar <strong>M1</strong> com uma chave aleatória <strong>K</strong> tem que ser igual a probabilidade de encriptar <strong>M2</strong>.</p>

<p>Isto significa que se alguém interceptar o texto cifrado de <strong>M2</strong>, por exemplo, como as probabilidades de encriptar <strong>M1</strong> e <strong>M2</strong> são iguais, <strong>não é possível saber se o texto cifrado é do <em>M2</em> ou se é do <em>M1</em> ou mesmo se é de qualquer outra mensagem</strong>.</p>

<p>Desta forma chegamos a outro conceito importante:</p>

<blockquote class="secondary-quote">
Não é possível fazer ataques a um texto cifrado que possua um <b>segredo perfeito</b> com o objetivo de saber o valor original.
</blockquote>

<p>o One Time Pad é seguro neste aspecto, pois possui um <strong>segredo perfeito</strong> e isto é simples de demonstrar:</p>

<ul>
<li>Para encriptar temos: <strong>E(k, m) = c</strong></li>
<li>No One Time Pad temos <strong>k XOR m = c</strong> e a propriedade XOR nos diz que isto implica em <strong>k = m XOR c</strong></li>
<li>Logo no universo de chaves <strong>K</strong> só é possível existir uma única chave <strong>k</strong> que satisfaça <strong>E(k, m) = c</strong></li>
</ul>

<p>A boa notícia é que deste modo, esta cifra é segura contra ataques feitos exclusivamente no conteúdo criptografado, mas vou mostrar ainda neste post como pelo menos 2 tipos de ataques a ela. Para garantir um segredo perfeito, é necessário que o tamanho da chave seja igual ao tamanho da mensagem, por isto este é uma das características que eu citei no início do post.</p>

<p>A má notícia é que depois que Shannon provou que a OTP possui segredo perfeito, ele também provou que para existir um segredo perfeito é necessário que o tamanho da chave tenha pelo menos o tamanho da mensagem. Aí complicou né amigo.</p>

<p>Ah! se estas letras (k, m&hellip;) ficaram confusas para você, dá uma olhadinha neste no meu post sobre <a href="/posts/o-que-%C3%A9-uma-cifra-de-chave-sim%C3%A9trica/">O que é uma cifra de chave simétrica?</a>)</p>

<h3 id="curiosidade-histórica">Curiosidade histórica</h3>

<hr />

<p>Então como um texto encriptado usando esta cifra é seguro contra ataques cujo objetivo é saber o conteúdo original, ela foi usada até por espiões para enviar informações, mas olha como isto era feito.</p>

<p>Imagina dois espiões, qual a maneira mais rápida de enviar uma informação de um ponto para o outro? simples, é ela já estar lá, logo a chave não era enviada de um ponto ao outro ela era compartilhada entre os dois espiões por meio de uma caderneta, dê uma olhada na imagem no cabeçalho do post.</p>

<p>Esta caderneta possuia diversas páginas com número aleatórios reais, para encriptar o espião 1 encriptava a mensagem usando caneta e papel, pois é apenas um XOR, e enviava a mensagem ao espião 2 juntamente com o número da página, logo após ele eliminava a respectiva página de sua caderneta. Quando o espião 2 recebia a mensagem, ele utilizava o número da página que recebeu para saber quais eram os números aleatórios utilizados, fazia a decriptação usando também um papel e caneta (quem sabe um lápis, vai saber) e eliminava a respectiva página também de sua caderneta.</p>

<p>Claro que se alguém tivesse acesso a caderneta a mensagem estava comprometida, mas a caderneta ficava de posse apenas do emissor e do receptor de forma a garantir a segurança do processo.</p>

<p>Mas haviam outras formas de fazer ataques a esta cifra?</p>

<h3 id="como-são-os-ataques-a-algo-cifrado-com-one-time-pad">Como são os ataques a algo cifrado com One Time Pad?</h3>

<hr />

<p>O One Time Pad tem este nome por um motivo especial, deve ser usado apenas uma única vez, caso contrário sofrerá um ataque muito básico chamado de <strong>two time pad</strong>. Veja:</p>

<ul>
<li>m1 XOR k1 = c1</li>
<li>m2 XOR k1 = c2</li>
<li>c1 XOR c2 = m1 XOR m2</li>
</ul>

<p>Ou seja, se alguém capturar duas mensagens encriptada com a mesma chave, consegue saber não exatamente a mensagem original, mas um XOR das mensagens originais e devido a redundância de um idiomas não é difícil recuperar o valor original, pois você não tem mais chave nenhuma no meio, apenas as mensagens originais.</p>

<p>Outra forma de ataque seria pra causar uma perturbação ou modificação na mensagem original, fazendo um XOR com um valor <strong>p</strong>, veja:</p>

<ul>
<li>Criptografar: m1 XOR k1 = c1</li>
<li>Modificar: c1 XOR p = (m1 XOR k1) XOR p</li>
<li>Decriptografar: ((m1 XOR k1) XOR p) XOR k1 = m1 XOR p</li>
</ul>

<p>Ou seja, ao fazer um XOR na mensagem encriptada modificando-a, causamos uma perturbação que ao retornar ao valor original pelo receptor usando a chave, não terá mais a mensagem original e isto abre espaço para modificações voluntárias se quem modificou a mensagem com um valor &ldquo;p&rdquo; souber alguma coisa da mensagem original.</p>

<p>Vamos a um exemplo bem simples, vamos supor que o interceptador sabe que a mensagem original começa com a palavra &ldquo;De Lorival&rdquo;, poderia fazer um XOR no texto encriptado para que resulta-se em &ldquo;De Marcelo&rdquo;, logo quando o receptor recebe-se a mensagem e decriptografa-se não veria &ldquo;De Marcelo&rdquo;. Mas claro, isto só funcionaria se o interceptador soube-se algo da mensagem original e também a respectiva posição.</p>

<h3 id="onde-aplicar-esta-cifra">Onde aplicar esta cifra?</h3>

<hr />

<p>Para concluir vimos que esta cifra possui um segredo perfeito, mas sua aplicação no mundo real não é assim tão prática. Talvez a forma mais simples de utilizar esta habilidade de segredo perfeito, seja utilizando ela como uma camada de criptografia depois de outra criptografia, criando duas camadas de encriptação, sendo que a segunda delas tem como objetivo ter um segredo perfeito e assim evitando o ataque de perturbação, por exemplo.</p>

<p>Mas é claro que neste caso o receptor e o emissor precisam ter as chaves previamente, assim como o exemplo dos espiões.</p>

<p>Eu gosto desta cifra, porque assim como a <strong>Cifra de Vigenère</strong> é uma evolução da <strong>Cifra de César</strong>, como pode ser visto em meu post <a href="/posts/uma-breve-hist%C3%B3ria-da-criptografia-parte-1-de-3/">Uma breve história da criptografia - Parte 1 de 3</a>), o <strong>One Time Pad</strong> é de certo modo uma evolução da <strong>Cifra de Vigenère</strong>, mas ao invés de ter uma palavra fixa repetida, possui valores aleatórios, ao invés de utilizar uma tabela, utiliza XOR que ainda permite computar de maneira manual e tudo isto agregando um conceito novo de segredo perfeito.</p>

<p>Quando olhamos as coisas e uma perspectiva de longo prazo, parece que certos conceitos surgiram do nada, mas na prática são sempre várias pequenas evoluções sempre agregando novos conceitos e melhorias.</p>

<p>Para finalizar deixo uma pergunta: se é tão complicado gerar números verdadeiramente aleatórios eu posso simplesmente usar o OTP com número pseudo-aleatórios? Claro que pode, mas neste caso não é mais um OTP e sim uma Cifra de fluxo (Stream cipher) e esta terá um post sobre ela.</p>

<p>Grande abraço e até lá ;)</p></p>
                                    <div>
                                        <hr>
                                        <span><i class="pe-7s-date" style="font-weight: bold"></i> Atualizado em 
    jul de 2018
</span>
                                    </div>
                                </div>
                                
                                <div class="sharethis-inline-reaction-buttons"></div>
                            </div>
                        </div>
                    </div>
                </article>
            </section>
        </div>

        <div class="articles-info">
            <section class="articles-info-section">
                <div class="container">
                    <div class="row">
                        <div class="col-lg-12 col-xs-12">
                            <div class="articles-author">
    <img src="/images/about/avatar.png" class="rounded-circle" alt="Lorival S. Chapuis" data-rjs="2">
    <div class="articles-author-right" style="margin: 0px 0 0 100px;">
        Escrito por:
        <h4>Lorival S. Chapuis</h4>
        
        <p>Engenheiro de software focado em escalabilidade, gamer nas horas de folga, entusiasta em inteligência computacional e apaixonado pela minha família e por desenvolvimento de software.</p>
    </div>
</div>
                        </div>
                    </div>
                </div>
            </section>
        </div>
        
        <div class="container">
            <div class="row" style="margin-top: 20px;">
                <div class="col-lg-12 col-xs-12">
                    <div id="disqus_thread"></div>
                </div>
            </div>
        </div>
    </main>
</body>

<footer>
    <div class="container">
        <div class="row">
            <div class="col-xs-12">
                <div class="copyright" style="text-align: center;">
                    <p class="font-primary" style="float: none;">
                        Made and hosted with <i class="fa fa-heart" style="color: #e25555;;"></i> using
                        <a href="https://gohugo.io/" target="_BLANK" class="black">Hugo</a> and <a href="https://pages.github.com/" target="_BLANK" class="black">Github Pages</a>. &copy; 2017-2020</p>
                </div>
            </div>
        </div>
    </div>
</footer>


<script type="text/javascript" src="/js/jquery-1.12.0.min.js"></script>
<script type="text/javascript" src="/js/tether.min.js"></script>
<script type="text/javascript" src="/js/bootstrap.min.js"></script>
<script type="text/javascript" src="/js/retina.min.js"></script>
<script type="text/javascript" src="/js/owl.carousel.min.js"></script>
<script type="text/javascript" src="/js/webfont.js"></script>


<script type="text/javascript" src="/js/scripts.js"></script>





<script>
    if (window.location.host.indexOf('loriv.al') > -1 && window.location.protocol != "https:"){
        window.location.protocol = "https";
    }
</script>

</body>

</html>