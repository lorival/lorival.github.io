<body class="body-blog-post">
    <!doctype html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
<meta name="viewport"
        content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Lorival Smolski Chapuis</title>
        <script data-ad-client="ca-pub-5019351576394165" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-60447750-1"></script>
        <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-60447750-1');
        </script>

        
        <script>
                (function(h,o,t,j,a,r){
                h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
                h._hjSettings={hjid:1770825,hjsv:6};
                a=o.getElementsByTagName('head')[0];
                r=o.createElement('script');r.async=1;
                r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
                a.appendChild(r);
                })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
        </script>

        <script type='text/javascript' src='https://platform-api.sharethis.com/js/sharethis.js#property=5e981c7368865d0012fff460&product=inline-share-buttons' async='async'></script>
        <script type='text/javascript' src='https://platform-api.sharethis.com/js/sharethis.js#property=5e981c7368865d0012fff460&product=sticky-share-buttons&cms=sop' async='async'></script>
        <script type='text/javascript' src='https://platform-api.sharethis.com/js/sharethis.js#property=5e981c7368865d0012fff460&product=inline-reaction-buttons&cms=sop' async='async'></script>
    <link rel="stylesheet" href="/css/bootstrap.css">
<link rel="stylesheet" href="/css/Pe-icon-7-stroke.css">
<link rel="stylesheet" href="/css/font-awesome.min.css">
<link rel="stylesheet" href="/css/social-icons.css">
<link rel="stylesheet" href="/css/owl.carousel.css">
<link rel="stylesheet" href="/css/owl.theme.css">

<link rel="stylesheet" href="/css/main.css">
    <link rel="apple-touch-icon" sizes="76x76" href="/images/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="152x152" href="/images/apple-touch-icon-152x152.png">
<link rel="icon" type="image/png" href="/images/favicon-196x196.png" sizes="196x196">
<link rel="icon" type="image/png" href="/images/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/images/favicon-32x32.png" sizes="32x32">

</head>
<body>

<header class="navbar-fixed-top">
    <div class="container">
        <div class="row">

            <div class="col-lg-12">
                <div class="header-top">
                    <div class="header-top-logo">
                        <a href="/" title="Full Stack Hacker"><img src="/images/home/logo.png" alt="Full Stack Hacker"></a>
                    </div>
                    <div class="header-top-text">
                        <p><span class="font-italic">“If knowledge can create problems, it is not through ignorance that we can solve them.”</span> Isaac Asimov</p>
                    </div>
                    <nav class="header-top-nav">
                        <ul>
                            
                            <li><a href="#" class="light-link" title="Menu">
                                <div id="menu-animate-icon" class="header-top-nav-menu-icon">
                                    <span></span>
                                    <span></span>
                                    <span></span>
                                </div>
                            </a></li>
                        </ul>
                    </nav>
                </div>
            </div>

            <div class="col-lg-12">
                <nav class="header-nav">
                    <ul>
                         
 
    
        <li>
            <a href="/pt/" title="Início">
                <span>Início</span>
            </a>
        </li>
     
 
    
        <li class="dropdown">
            <a href="#" class="dropdown-toggle" title="Artigos">Artigos</a>
            <ul class="dropdown-menu">
                
    
         
    
         
    
         
    
        
            <li class="nav-elipse-green">
                <a href="/categories/security" title="Security">Security</a>
            </li>
         
    
         
    



            </ul>
        </li>
     
 
    
        <li>
            <a href="/inspirations/" title="Inspirações">
                <span>Inspirações</span>
            </a>
        </li>
     
 
    
        <li>
            <a href="/about/" title="Sobre mim">
                <span>Sobre mim</span>
            </a>
        </li>
     


<li style="float: right">
    
</li>
                    </ul>
                </nav>
            </div>
        </div>
  
    </div>
</header>

<nav class="mobile-nav header-nav">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                
            </div>
        </div>
    </div>
</nav>


    <div class="article-nav">
        <ul>
            <li>
                
                <a href="/posts/o-que-%C3%A9-uma-cifra-de-chave-sim%C3%A9trica/" title="Próximo" style="background-color: rgba(243, 243, 243, 0.95);">
                    <i class="pe-7s-angle-right"></i>
                    <div>
                        <p>Próximo</p>
                        <h3>O que é uma cifra de chave simétrica?</h3>
                    </div>
                </a>
                
            </li>
            <li>
                
                <a href="/posts/uma-breve-hist%C3%B3ria-da-criptografia-parte-1-de-3/" title="Anterior" style="background-color: rgba(243, 243, 243, 0.95);">
                    <i class="pe-7s-angle-left"></i>
                    <div>
                        <p>Anterior</p>
                        <h3>Uma breve história da criptografia - Parte 1 de 3</h3>
                    </div>
                </a>
                
            </li>
        </ul>
    </div>

    <main>
        <div class="container">
            <section class="articles articles-blog-post">
                <article class="articles-blog-post">
                    <div class="">
                        <div class="row">
                            <div class="col-lg-12 col-xs-12">
                                
     

     

     

    
        <div style="height: 10px;" class="bkg-green"></div>
     

     

                                <div class="articles-header">
                                    <span><i class="pe-7s-clock" style="font-weight: bold"></i> Leia em 9 min &nbsp;</span>
                                    <span><i class="pe-7s-date" style="font-weight: bold"></i> 
    mar de 2018
</span>
                                    
                                    
     

     

     

        
        <span class="articles-header-category">
            <a href="/categories/security" class="green" title="Security">Security</a>
        </span>
     

     


                                </div>
                                <div class="articles-content" style="text-align: justify;">
                                    <img src="/posts/2018/03-generating-random-numbers.jpg" style="width: 100%;height: auto;">
                                    <div class="articles-header" style="margin: 0px;">
                                        
    <span class="articles-header-tag">
        <a href="/tags/statistics">statistics</a>
    </span>

    <span class="articles-header-tag">
        <a href="/tags/algorithm">algorithm</a>
    </span>

    <span class="articles-header-tag">
        <a href="/tags/prg">prg</a>
    </span>


                                    </div>
                                    <h1 class="articles-content-blog-post-title"><a href="/personas/" class="light-link">
    <img src="/images/persona/junior.png" title="junior" style="width: 50px; height:auto;">
</a>
 Números aleatórios gerados por computador são mesmo aleatórios?</h1>
                                    <p><p>Eu já participei de um sorteio uma vez que levava em consideração a utilização de um número aleatório gerado por uma função em Pascal, mas será mesmo que este sorteio foi estatisticamente justo? Porque grandes sorteios ainda usam globos ou coisas físicas para efetuar um sorteio ao invés de usar o computador? Você já participou por algo assim ou já parou para pensar quão aleatório são realmente os números gerados por estas funções e quão fácil ou difícil é gerar números aleatórios?</p>

<p>Saaaaaalve hacker, nossa que assunto mais aleatório: falar de números aleatórios :) o fato é que números aleatórios são importantes para modelos estatísticos, simulações de fenômenos físicos em pesquisas, jogos de computador, jogos de azar e claro o foco aqui na criptografia, para geração de chaves, mas isto eu tratarei em outro post.</p>

<p>A primeira pergunta é objetiva: os números aleatórios gerados por computador são mesmo aleatórios?</p>

<p>Para responder isto temos que primeiro falar de <a href="https://pt.wikipedia.org/wiki/Aleatoriedade">aleatoriedade</a>, que implica em não seguir um padrão determinístico ao mesmo tempo que segue uma <a href="https://pt.wikipedia.org/wiki/Distribui%C3%A7%C3%A3o_de_probabilidade">distribuição de probabilidade</a>.</p>

<h2 id="distribuição-de-probabilidade">Distribuição de probabilidade</h2>

<hr />

<p>A definição matemática é muito simples e é importante de ser entendida. Como você é dev como eu, vou dar uma definição matemática para desenvolvedores, penso que seja mais fácil de entendermos.</p>

<script src="https://gist.github.com/lorival/d69e531ed6d93b372e8d75e919ef801e.js"></script>

<p>Logo, matematicamente, uma distribuição de probabilidade é basicamente uma função cujo retorno é um número entre 0 e 1 que representa a probabilidade de um determinado número ser selecionado dentro de um conjunto finito de elementos. Um destaque importante, não incluído no código, é que a soma da probabilidade de todos os números de um conjunto deve ser igual a 1, ou seja, 100%. Eu usei o tipo de dados &ldquo;long&rdquo; no código, apenas para ilustrar um conjunto de números gigantes.</p>

<p>Como você viu no código, distribuição de probabilidade é uma interface, ou seja existem várias <a href="https://pt.wikipedia.org/wiki/Lista_de_distribui%C3%A7%C3%B5es_de_probabilidade">distribuições de probabilidade</a>, mas para exemplificar vamos ver uma delas: a <a href="https://pt.wikipedia.org/wiki/Distribui%C3%A7%C3%A3o_uniforme">distribuição uniforme</a>.</p>

<p>Vejamos novamente em código como é a distribuição uniforme:</p>

<script src="https://gist.github.com/lorival/187228615efb01d3b8a963db663b60fd.js"></script>

<p>Fácil de entender assim não é? basicamente em uma distribuição uniforme a probabilidade de obter um número é igual para todos, portanto o número em si não importa, nem todas as distribuições são assim esta característica define esta distribuição como uniforme. Em termos práticos é basicamente <strong>1 / [tamanho do conjunto]</strong>, por exemplo, se você tem um dado com 6 faces e jogar para cima, a probabilidade de um dos lados cair com a face para cima é de <sup>1</sup>&frasl;<sub>6</sub>, independente de qual lado é.</p>

<p>Desta forma, qualquer valor aleatório dentro de uma distribuição uniforme tem sempre a mesma probabilidade de qualquer outro valor aleatório para o mesmo conjunto de valores, por exemplo, um número aleatório entre 1 e 100 deve ter a probabilidade de <sup>1</sup>&frasl;<sub>100</sub>.</p>

<p>Como criar uma função que garanta esta probabilidade? um computador repete os passos que lhe dizemos, mas se ele está a seguir passos logo os valores não poderiam ser aleatórios, pois em teoria poderiam ser previsiveis, bastaria entender qual função está gerando estes números.</p>

<p>Talvez algo simples que possa vir em sua mente seria um serviço que após gerar um número aleatório guardasse este valor, desta forma cada vez que um novo número fosse gerado retornaria um valor aleatório de um número que ainda não tenha sido gerado antes. Além do problema de necessitar de memória, esta memória nunca poderia ser corrompida nem interrompida, pois começaria a contar do zero novamente e os próximos valores gerados não seguiriam mais a distribuição uniforme. Temos que pensar também que funções aleatórias podem ser implementadas tanto em software como em hardware, algumas solução são específicas, mas existem soluções híbridas também.</p>

<p>Então respondendo a pergunta inicial: se usamos funções para gerar números aleatórios, logo estes números não são verdadeiramente aleatórios portanto são chamados de números pseudo-aleatórios, os geradores destes números são conhecidos como PRG: Pseudorandom generator.</p>

<h2 id="pseudorandom-generator-prg">Pseudorandom generator (PRG)</h2>

<hr />

<p>Agora veja algo curioso, a distribuição uniforme nos diz que dentro de um conjunto de 20 números, a probabilidade de sair cada número é igual certo? Sim! Então vamos supor que você gere 4 números e sejam estes <em>3, 5, 7, 9</em>, mesmo que nenhum número se repetiu você fácilmente consegue prever o próximo número, que deve ser o <em>11</em>. Este é um exemplo absurdo, que serve apenas para ilustrar.</p>

<p>Então um PRG precisa de uma característica importante: <strong>ser imprevisível</strong>, ou seja, não pode ser possível prever o próximo número.</p>

<p>Um PRG que jamais deve ser usado em produção para criptografia é o <a href="https://pt.wikipedia.org/wiki/Geradores_congruentes_lineares">gerador congruente linear</a>, mas ele pode ser usado para entendermos como funciona.</p>

<script src="https://gist.github.com/lorival/be6e9158a7e63df760dbe7caa0ce0359.js"></script>

<p>Esta é apenas uma das famílias deste algoritmo, a que eu penso ser a mais simples de entender apenas lendo, em resumo estatisticamente este é um bom algoritmo para gerar números aleatórios, até poderia utilizá-lo para um sorteio simples, mas jamais para aplicar em criptografia, pois se você souber os parâmetros você descobre qual será o próximo número.</p>

<p>Apenas de curiosidade, um algoritmo famoso de número aleatórios que tem características lineares e não deve ser usado jamais na criptografia também é da lib <a href="https://www.mathstat.dal.ca/~selinger/random/">glibc</a>.</p>

<p>Para ter uma ideia de quão complexo matematicamente isto é, existem hardwares que utilizam de impulsos físicos para gerar números verdadeiramente aleatórios, quer gerar um número no computador verdadeiramente aleatório e de graça? Acesse <a href="https://www.random.org/">Generate true random number</a>. Agora sim, sempre que você for fazer aquele sorteio rápido para qualquer coisa, use este link e fique tranquilo :)</p>

<p>Certo, então entendemos que é possível gerar números aleatórios estatisticamente bons, mas o que é preciso para gerar um número aleatório seguro?</p>

<h2 id="definição-de-um-prg-seguro">Definição de um PRG seguro</h2>

<hr />

<p>Como podemos saber se um valor gerado por um PRG é indistinguível de um verdadeiro valor aleatório?
Para isto precisamos do conceito de teste estatístico, que basicamente é uma função que recebe uma string com vários números gerados e retorna &ldquo;1&rdquo; se for um valor realmente aleatório e &ldquo;0&rdquo; se não for aleatório.</p>

<p>Um exemplo bem simples, vamos supor que desejamos verificar se a quantidade de vezes que o número &ldquo;0&rdquo; apareceu dentro da string de entrada seja aproximadamente igual ao número de &ldquo;1&rdquo; dentro da mesma string. Para isto teríamos que fazer: ([quantidade de 0] - [quantidade de 1]) &lt;= 10 * raiz quadrada da [quantidade total de caracteres].</p>

<p>Existem muitos testes estatísticos como este, mas então temos outra pergunta, como saber se um teste estatístico é bom ou ruim?
Para isto precisamos de um conceito chamado <strong>vantagem</strong>, ela é a relação de um teste estatístico e um gerador de números pseudo-aleatórios e é basicamente o resultado da subtração de 2 valores:</p>

<p><em>Vantagem PRG [teste A, gerador G] = (a probabilidade do teste estatístico retornar &ldquo;1&rdquo;, quando damos a ele uma string com valores aleatórios gerados pelo gerador) - (a probabilidade do teste estatístico retornar &ldquo;1&rdquo;, quando damos a ele uma string com valores realmente aleatórios)</em></p>

<p>O resultado desta subtração sempre será um número entre &ldquo;0&rdquo; e &ldquo;1&rdquo;:
- se o resultado for número for próximo de &ldquo;1&rdquo; significa que este teste estatístico consegue saber a diferença entre o valor gerado pelo gerador e um número aleatório, ou seja é um bom teste para se usar,
- se o resultado for um número próximo de &ldquo;0&rdquo; significa que o teste não consegue saber a diferença entre um valor aleatório e o valor gerado pelo gerador, portanto não vale a pena ser usado para validar este gerador.</p>

<p>Vamos calcular um exemplo de vantagem:
- Vamos dizer que <sup>2</sup>&frasl;<sub>3</sub> das chaves geradas possuem o primeiro valor como &ldquo;1&rdquo;,
- Vamos dizer também que o teste estatístico é o seguinte: se a maioria dos valores da string for &ldquo;1&rdquo; retorna &ldquo;1&rdquo;, senão retorna &ldquo;0&rdquo;,
- Por último vamos dizer que a probabilidade do teste estatístico saber a diferença entre um número aleatório e não aleatório é de <sup>1</sup>&frasl;<sub>2</sub> (50%).</p>

<p>A vantagem = <sup>2</sup>&frasl;<sub>3</sub> - <sup>1</sup>&frasl;<sub>2</sub> = <sup>1</sup>&frasl;<sub>6</sub> = 0.1667, este número não é pequeno suficiente para ser desprezível, portanto significa que este teste consegue quebrar o gerador com uma vantagem de <sup>1</sup>&frasl;<sub>6</sub>, ou seja, consegue distinguir entre um valor aleatório real e um não real com uma vantagem de <sup>1</sup>&frasl;<sub>6</sub>. É uma vantagem pequena, é claro, mas não é desprezível e pode ser usado.</p>

<p><strong>Agora que sabemos como definir um teste estatístico que possa validar um gerador de números aleatórios, a definição de um PRG seguro é um PRG que consiga passar em diversos testes estatísticos que são efetivos para ele, ou seja, que consigam quebrá-lo com alguma vantagem não despezível.</strong></p>

<p>Por fim sabemos que um gerador de números aleatórios ou PRG seguro precisa:
- Ter valores gerados completamente imprevisíveis, ou seja, os valores não podem ter uma correlação entre si,
- Ter valores gerados dentro de uma distribuição de probabilidade conhecida, como por exemplo a distribuição uniforme.</p>

<p>Agora sim vamos nos encaminhando para o final, você deve estar ansioso para saber exemplos de PRG seguros, não é mesmo? ou pelo menos um exemplo com um link salvo na sessão <strong>Links para guardar</strong> :)
Infelizmente hoje não existe exemplos de PRGs seguros! Kcetada, como assim? Este é um daqueles famosos problemas <a href="https://pt.wikipedia.org/wiki/NP-completo">NP completos</a>, ou seja, se conseguíssemos provar que alguma PRG é seguro estariamos resolvendo um dos problemas mais famosos na ciência da computação, o <a href="https://pt.wikipedia.org/wiki/P_versus_NP">P versus NP</a>.</p>

<p>O máximo que é possível fazer é oferecer PRGs candidados a serem seguros, mas isto eu vou tratar em outro post para não tornar este muito extenso. O objetivo deste post era entender se os números aleatórios gerados por computador são mesmo aleatórios e sabemos agora que técnicamente não, são pseudo-aleatórios.</p>

<p>Depois de entender um pouco o trabalho que existe para obter um PRG seguro, podemos entender porque é mais fácil utilizar globos com bolinhas para efetuar um sorteio do que usar uma função que gera números pseudo-aleatórios. Por isto que um modelo híbrido, ou seja, um hardware que analisa ruídos (termal, fotoelétrico, acústico) e converte números, é mais confiável do que um algoritmo puramente baseado em uma função, pois na prática não está a gerar um número aleatório está a converter um número aleatório gerado no mundo físico para o mundo digital.</p>

<p>Então na próxima vez que pensar em números aleatórios gerados por computador, pense duas vezes :)</p>

<p>Graaaaaaaaande abraço e até já!</p>

<hr />

<h3 id="links-para-guardar">Links para guardar</h3>

<ul>
<li><a href="https://www.random.org/">Gerador de números verdadeiramente aleatórios baseado em ruídos físicos grátis</a></li>
</ul></p>
                                    <div>
                                        <hr>
                                        <span><i class="pe-7s-date" style="font-weight: bold"></i> Atualizado em 
    mar de 2018
</span>
                                    </div>
                                </div>
                                
                                <div class="sharethis-inline-reaction-buttons"></div>
                            </div>
                        </div>
                    </div>
                </article>
            </section>
        </div>

        <div class="articles-info">
            <section class="articles-info-section">
                <div class="container">
                    <div class="row">
                        <div class="col-lg-12 col-xs-12">
                            <div class="articles-author">
    <img src="/images/about/avatar.png" class="rounded-circle" alt="Lorival S. Chapuis" data-rjs="2">
    <div class="articles-author-right" style="margin: 0px 0 0 100px;">
        Escrito por:
        <h4>Lorival S. Chapuis</h4>
        
        <p>Engenheiro de software focado em escalabilidade, gamer nas horas de folga, entusiasta em inteligência computacional e apaixonado pela minha família e por desenvolvimento de software.</p>
    </div>
</div>
                        </div>
                    </div>
                </div>
            </section>
        </div>
        
        <div class="container">
            <div class="row" style="margin-top: 20px;">
                <div class="col-lg-12 col-xs-12">
                    <div id="disqus_thread"></div>
                </div>
            </div>
        </div>
    </main>
</body>

<footer>
    <div class="container">
        <div class="row">
            <div class="col-xs-12">
                <div class="copyright" style="text-align: center;">
                    <p class="font-primary" style="float: none;">
                        Made and hosted with <i class="fa fa-heart" style="color: #e25555;;"></i> using
                        <a href="https://gohugo.io/" target="_BLANK" class="black">Hugo</a> and <a href="https://pages.github.com/" target="_BLANK" class="black">Github Pages</a>. &copy; 2017-2020</p>
                </div>
            </div>
        </div>
    </div>
</footer>


<script type="text/javascript" src="/js/jquery-1.12.0.min.js"></script>
<script type="text/javascript" src="/js/tether.min.js"></script>
<script type="text/javascript" src="/js/bootstrap.min.js"></script>
<script type="text/javascript" src="/js/retina.min.js"></script>
<script type="text/javascript" src="/js/owl.carousel.min.js"></script>
<script type="text/javascript" src="/js/webfont.js"></script>


<script type="text/javascript" src="/js/scripts.js"></script>





<script>
    if (window.location.host.indexOf('loriv.al') > -1 && window.location.protocol != "https:"){
        window.location.protocol = "https";
    }
</script>

</body>

</html>